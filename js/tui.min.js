const MAIN_CONTAINER = document.getElementById("main-container");const SECTION_CONTAINER = document.getElementById("section-container");const LEFT_SECTION = document.getElementById("left-section");const RIGHT_SECTION = document.getElementById("right-section");const HOME_SECTION = document.getElementById("home");const SKILLS_SECTION = document.getElementById("skills");const PROJECTS_SECTION = document.getElementById("projects");const FOOTER_SECTION = document.getElementById("footer");const MAIN_CONTENT_SECTION = document.getElementById("main-content")?.getElementsByClassName("container-content")[0];const COLORS = ["text-blue", "text-orange", "text-pink"];// Define sections with their itemsconst left_sections = [{ name: "home", section: HOME_SECTION, items: [] },{name: "projects",section: PROJECTS_SECTION,items: [...PROJECTS_SECTION.firstElementChild.children[2].children],},{name: "skills",section: SKILLS_SECTION,items: [...SKILLS_SECTION.firstElementChild.children[2].children],},];const currentPosition = {sectionIndex: 0,sectionItemIndex: 0,};const previousPosition = {sectionIndex: 0,sectionItemIndex: 0,};function clamp(min, value, max) {return Math.min(Math.max(min, value), max);}function isMobile() {return window.innerWidth <= 768;}function getRandomTextColorClass() {return COLORS[Math.floor(Math.random() * COLORS.length)];}function colorizeString(str) {return str.replaceAll("{{", () => `<span class="${getRandomTextColorClass()}">`).replaceAll("}}", "</span>");}function colorizeCode() {const element = document.getElementsByTagName("code")[0];if (element == null) {return;}const text = element.innerText;const language = element.classList[0];// Define keywords for syntax highlightingconst javascriptKeywords = [["document", "window", "null", "undefined", "true", "false"],["function", "const", "let", "var", "return", "if", "else", "for", "while"],["addEventListener", "querySelector", "getElementById", "fetch"],];const keywords = {js: javascriptKeywords,c: [["NULL", "true", "false"],["typedef", "struct", "void", "return", "if", "else", "while"],],cpp: [["NULL", "true", "false"],["class", "public", "private", "void", "return", "if", "else", "while"],],python: [["None", "True", "False"],["def", "class", "return", "if", "else", "for", "while", "import", "from"],]}[language];if (keywords == null) {return;}let coloredText = text;keywords.forEach((subKeywords, i) => {if (subKeywords.length === 0) {return;}const regex = new RegExp(`\\b(${subKeywords.join("|")})\\b`, "g");coloredText = coloredText.replaceAll(regex,(match) => `<span class="${COLORS[i]}">${match}</span>`,);});element.innerHTML = coloredText;}async function getCodeSnippet(snippet) {try {const response = await fetch(`data/snippets/snippet.${snippet}`);const text = await response.text();return text;} catch (error) {console.error("Error fetching code snippet:", error);return "// Error loading code snippet";}}function isVisibleInScrollView(element, container) {const elementTop = element.offsetTop;const elementBottom = elementTop + element.clientHeight;const containerTop = container.scrollTop;const containerBottom = containerTop + container.clientHeight;return elementTop >= containerTop && elementBottom <= containerBottom;}function onHamburgerMenuPress() {const hamburgerButtonElement =document.getElementsByName("hamburger-toggle")[0];const navContainerElement =document.getElementsByClassName("nav-container")[0];if (hamburgerButtonElement.checked) {LEFT_SECTION.classList.add("menu-open");navContainerElement.style.opacity = 1;} else {LEFT_SECTION.classList.remove("menu-open");navContainerElement.style.opacity = 0.9;}}function closeHamburgerMenu() {const hamburgerButtonElement =document.getElementsByName("hamburger-toggle")[0];hamburgerButtonElement.checked = false;LEFT_SECTION.classList.remove("menu-open");}function clearMainContent() {MAIN_CONTENT_SECTION.innerHTML = "";MAIN_CONTENT_SECTION.scrollTo({ top: 0 });}async function displayContent() {try {clearMainContent();const sectionName = left_sections[currentPosition.sectionIndex].name;console.log(`Loading content for section: ${sectionName}, item: ${currentPosition.sectionItemIndex}`);// Add loading indicatorconst loadingElement = document.createElement("div");loadingElement.innerHTML = '<p>Loading content...</p>';MAIN_CONTENT_SECTION.appendChild(loadingElement);// Fetch the data with relative pathconst response = await fetch(`data/${sectionName}.json`);if (!response.ok) {throw new Error(`Failed to fetch ${sectionName}.json: ${response.status}`);}const { data } = await response.json();// Clear the loading indicatorclearMainContent();const outerContainerElement = document.createElement("div");outerContainerElement.classList.add("outer-paragraph-container");const innerContainerElement = document.createElement("div");innerContainerElement.classList.add("inner-paragraph-container");if (sectionName !== "home") {innerContainerElement.classList.add("mt-4");const sectionData = data[currentPosition.sectionItemIndex];console.log(`Loaded data for ${sectionName} item: ${sectionData.name || currentPosition.sectionItemIndex}`);const topElement = document.createElement("div");// Add title if available (use name for projects and skills)const titleElement = document.createElement("h1");titleElement.innerHTML =sectionData.name != null? `<span class="${getRandomTextColorClass()}">${sectionData.name}</span>`: null;// Add year if availableconst yearElement = document.createElement("h2");yearElement.innerHTML =sectionData.year != null? `[Built in <span class="${getRandomTextColorClass()}">${sectionData.year}</span>]`: null;// Add technologies if availableconst technologiesContainerElement = document.createElement("div");technologiesContainerElement.classList.add("technologies-row");technologiesContainerElement.innerHTML =sectionData.technologies?.map((t) => colorizeString(t)).join(" ") || null;// Add buttons for GitHub and demo if availableconst buttonsContainerElement = document.createElement("div");buttonsContainerElement.classList.add("buttons-container");if (sectionData?.githubUrl) {const githubButtonElement = document.createElement("a");githubButtonElement.classList.add("project-button");githubButtonElement.href = sectionData.githubUrl;githubButtonElement.target = "_blank";githubButtonElement.innerText = "GitHub";buttonsContainerElement.appendChild(githubButtonElement);}if (sectionData?.demoUrl) {const demoButtonElement = document.createElement("a");demoButtonElement.classList.add("project-button");demoButtonElement.href = sectionData.demoUrl;demoButtonElement.target = "_blank";demoButtonElement.innerText = "Demo";buttonsContainerElement.appendChild(demoButtonElement);}// Add elements to the top containerif (titleElement.innerHTML != null) {topElement.appendChild(titleElement);}if (yearElement.innerHTML != null) {topElement.appendChild(yearElement);}if (technologiesContainerElement.innerHTML != null) {topElement.appendChild(technologiesContainerElement);}if (buttonsContainerElement.children.length > 0) {topElement.appendChild(buttonsContainerElement);}// Add images if availableconst imageElements =sectionData.images?.map((imagePath) => {const imageInnerContainerElement = document.createElement("div");imageInnerContainerElement.style.minHeight = "200px";imageInnerContainerElement.classList.add("image-inner-container");const imageElement = document.createElement("img");imageElement.loading = "lazy";imageElement.alt = "Project image";imageElement.decoding = "async";imageElement.src = `images/${imagePath}`;imageElement.classList.add("project-image");imageInnerContainerElement.appendChild(imageElement);return imageInnerContainerElement;}) ?? [];// Add content paragraphssectionData.content.forEach((c, i) => {const element = document.createElement("div");element.innerHTML = colorizeString(c).replaceAll("\\n", "<br>");innerContainerElement.appendChild(element);// Add image if availableif (i < imageElements.length) {const imageContainerElement = document.createElement("div");imageContainerElement.classList.add("image-container");imageContainerElement.appendChild(imageElements[i]);innerContainerElement.appendChild(imageContainerElement);}});// Add code snippet if availableif (sectionData?.snippet != null) {const snippetContainerElement = document.createElement("div");snippetContainerElement.classList.add("snippet-container");const snippetElement = document.createElement("pre");const codeElement = document.createElement("code");codeElement.classList.add(sectionData.snippet);snippetElement.appendChild(codeElement);codeElement.innerText = await getCodeSnippet(sectionData.snippet);snippetContainerElement.appendChild(snippetElement);innerContainerElement.appendChild(snippetContainerElement);}// Add everything to the main containerinnerContainerElement.prepend(topElement);outerContainerElement.appendChild(innerContainerElement);clearMainContent();MAIN_CONTENT_SECTION.appendChild(outerContainerElement);colorizeCode();} else {// Home sectionconst logoFileName = `images/logo${Math.floor(Math.random() * 4) + 1}.svg`;const logoContainer = document.createElement("div");logoContainer.id = "logo-container";const logoElement = document.createElement("img");logoElement.loading = "eager";logoElement.src = logoFileName;logoElement.id = "logo";logoElement.alt = "Chaitany Patel";logoContainer.appendChild(logoElement);clearMainContent();MAIN_CONTENT_SECTION.appendChild(logoContainer);// Add home contentdata.forEach((d) => {const element = document.createElement("div");d.content.forEach((c) => {const paragraph = document.createElement("p");paragraph.innerHTML = colorizeString(c);element.appendChild(paragraph);});innerContainerElement.appendChild(element);});outerContainerElement.appendChild(innerContainerElement);MAIN_CONTENT_SECTION.appendChild(outerContainerElement);}} catch (error) {console.error("Error displaying content:", error);clearMainContent();const errorElement = document.createElement("div");errorElement.innerHTML = `<p>Error loading content: ${error.message}</p>`;MAIN_CONTENT_SECTION.appendChild(errorElement);}}function clearSelectionStyling(scrollToTop) {if (isMobile()) {const selectedElement = document.getElementsByClassName("selected-item")[0];const selectedFrameElement =document.getElementsByClassName("selected-frame")[0];if (selectedElement != null) {selectedElement.classList.remove("selected-item");}if (selectedFrameElement != null) {selectedFrameElement.classList.remove("selected-frame");}}const previousSection = left_sections[previousPosition.sectionIndex];const previousSectionItemElement =previousSection.items[previousPosition.sectionItemIndex];const previousSectionItemIndexElement =previousSection.section.getElementsByClassName("list-index")[0]?.firstElementChild;const scrollableContainerElement =previousSection.section.getElementsByClassName("ui-list")[0];previousSection.section.classList.remove("selected-frame");previousSectionItemElement?.classList.remove("selected-item");if (previousSectionItemIndexElement != null) {previousSectionItemIndexElement.innerText = `1 of ${previousSection.items.length}`;}if (scrollableContainerElement != null && scrollToTop) {scrollableContainerElement.scrollTo({ top: 0 });}}async function render(scrollToTop = false, isInitialRender = false) {try {console.log(`Rendering: section=${currentPosition.sectionIndex}, item=${currentPosition.sectionItemIndex}`);if (!isMobile() &&!isInitialRender &&currentPosition.sectionIndex === previousPosition.sectionIndex &&currentPosition.sectionItemIndex === previousPosition.sectionItemIndex) {console.log("No change in position, skipping render");return;}const currentSection = left_sections[currentPosition.sectionIndex];console.log(`Current section: ${currentSection.name}`);const currentSectionItemElement =currentSection.items?.[currentPosition.sectionItemIndex];const currentSectionItemIndexElement =currentSection.section.getElementsByClassName("list-index")[0]?.firstElementChild;const scrollableContainerElement =currentSection.section.getElementsByClassName("ui-list")[0];clearSelectionStyling(scrollToTop);currentSection.section.classList.add("selected-frame");if (currentSectionItemElement) {currentSectionItemElement.classList.add("selected-item");console.log(`Selected item: ${currentSectionItemElement.textContent}`);}if (currentSectionItemIndexElement != null) {currentSectionItemIndexElement.innerText = `${currentPosition.sectionItemIndex + 1} of ${currentSection.items.length}`;}// Handle scrolling for items not in viewif (scrollableContainerElement != null && currentSectionItemElement != null) {if (!isVisibleInScrollView(currentSectionItemElement,scrollableContainerElement,) &&previousPosition.sectionItemIndex !== currentPosition.sectionItemIndex) {const gap = parseInt(window.getComputedStyle(currentSectionItemElement).gap,);scrollableContainerElement.scrollBy({top:previousPosition.sectionItemIndex < currentPosition.sectionItemIndex? currentSectionItemElement.clientHeight + gap: -currentSectionItemElement.clientHeight - gap,behavior: "instant",});}}// Always display contentawait displayContent();if (isMobile()) {closeHamburgerMenu();}console.log("Render complete");} catch (error) {console.error("Error during rendering:", error);}}function savePreviousPosition() {previousPosition.sectionIndex = currentPosition.sectionIndex;previousPosition.sectionItemIndex = currentPosition.sectionItemIndex;}function goToSection(sectionNumber, itemNumber = 0) {savePreviousPosition();currentPosition.sectionIndex = clamp(0,sectionNumber,left_sections.length - 1,);currentPosition.sectionItemIndex = clamp(0,itemNumber,left_sections[currentPosition.sectionIndex].items.length - 1,);}function goToNextSection() {savePreviousPosition();currentPosition.sectionIndex = clamp(0,currentPosition.sectionIndex + 1,left_sections.length - 1,);currentPosition.sectionItemIndex = 0;}function goToPreviousSection() {savePreviousPosition();currentPosition.sectionIndex = clamp(0,currentPosition.sectionIndex - 1,left_sections.length - 1,);currentPosition.sectionItemIndex = 0;}function goToNextItem() {savePreviousPosition();currentPosition.sectionItemIndex = clamp(0,currentPosition.sectionItemIndex + 1,left_sections[currentPosition.sectionIndex].items.length - 1,);}function goToPreviousItem() {savePreviousPosition();currentPosition.sectionItemIndex = clamp(0,currentPosition.sectionItemIndex - 1,left_sections[currentPosition.sectionIndex].items.length - 1,);}function scrollMainContentDown() {MAIN_CONTENT_SECTION?.scrollBy({top: MAIN_CONTENT_SECTION.clientHeight / 2,});}function scrollMainContentUp() {MAIN_CONTENT_SECTION?.scrollBy({top: -(MAIN_CONTENT_SECTION.clientHeight / 2),});}function initKeyboardListeners() {// Simple direct keyboard event listenerdocument.addEventListener('keydown', async (event) => {const { key, code, ctrlKey } = event;console.log(`Key pressed: ${key}`);// Prevent default browser behavior for navigation keysif (key.includes("Arrow") || key.includes("Page") ||key === 'h' || key === 'j' || key === 'k' || key === 'l') {event.preventDefault();event.stopPropagation();}// Process the key presslet scrollToTop = false;try {if (key === "PageDown" || (ctrlKey && key === "d")) {scrollMainContentDown();return;} else if (key === "PageUp" || (ctrlKey && key === "u")) {scrollMainContentUp();return;} else if (key === "ArrowUp" || key === "k") {if (currentPosition.sectionIndex === 0) {return;}goToPreviousItem();console.log('Moving to previous item');} else if (key === "ArrowDown" || key === "j") {if (currentPosition.sectionIndex === 0) {return;}goToNextItem();console.log('Moving to next item');} else if (key === "ArrowLeft" || key === "h") {goToPreviousSection();scrollToTop = true;console.log('Moving to previous section');} else if (key === "ArrowRight" || key === "l") {goToNextSection();scrollToTop = true;console.log('Moving to next section');} else if (code?.includes("Digit")) {const sectionNumber = parseInt(key) - 1;goToSection(sectionNumber);scrollToTop = true;console.log(`Jumping to section ${sectionNumber}`);} else {// Just here to avoid rendering on every keypressreturn;}await render(scrollToTop);} catch (error) {console.error('Error processing key press:', error);}});console.log('Keyboard listeners initialized');}function initMouseListeners() {try {console.log("Initializing mouse listeners...");// Add click handlers for each sectionleft_sections.forEach((section, sectionIndex) => {console.log(`Setting up listeners for section: ${section.name}, items: ${section.items.length}`);// Add click handlers for each item in the sectionsection.items.forEach((item, itemIndex) => {if (item) {item.style.cursor = "pointer";item.addEventListener("click", async (event) => {event.stopPropagation();console.log(`Clicked on ${section.name} item ${itemIndex}`);goToSection(sectionIndex, itemIndex);await render(sectionIndex !== previousPosition.sectionIndex);});}});// Add click handler for the section itselfif (section.section) {section.section.addEventListener("click", async () => {console.log(`Clicked on section: ${section.name}`);goToSection(sectionIndex);await render(sectionIndex !== previousPosition.sectionIndex);});}});console.log("Mouse listeners initialized");} catch (error) {console.error("Error initializing mouse listeners:", error);}}function initTouchListeners() {if (!isMobile()) {return;}const hamburgerButtonElement =document.getElementsByName("hamburger-toggle")[0];hamburgerButtonElement.addEventListener("click", () => {onHamburgerMenuPress();});}async function init() {try {console.log("Initializing portfolio application...");// Check if DOM elements existif (!HOME_SECTION || !PROJECTS_SECTION || !SKILLS_SECTION) {console.error("Critical page sections not found:", {home: !!HOME_SECTION,projects: !!PROJECTS_SECTION,skills: !!SKILLS_SECTION});return;}console.log("All critical page sections found");// Make sure items are properly initializedif (PROJECTS_SECTION && PROJECTS_SECTION.firstElementChild && PROJECTS_SECTION.firstElementChild.children[2]) {left_sections[1].items = [...PROJECTS_SECTION.firstElementChild.children[2].children];console.log(`Projects items: ${left_sections[1].items.length}`);} else {console.error("Could not find projects items");}if (SKILLS_SECTION && SKILLS_SECTION.firstElementChild && SKILLS_SECTION.firstElementChild.children[2]) {left_sections[2].items = [...SKILLS_SECTION.firstElementChild.children[2].children];console.log(`Skills items: ${left_sections[2].items.length}`);} else {console.error("Could not find skills items");}// Make items look clickableleft_sections.forEach(section => {section.items.forEach(item => {if (item) {item.style.cursor = "pointer";}});});// Initialize event listenersconsole.log("Initializing keyboard listeners...");initKeyboardListeners();console.log("Initializing mouse listeners...");initMouseListeners();console.log("Initializing touch listeners...");initTouchListeners();// Initial renderconsole.log("Performing initial render...");await render(true, true);console.log("Initialization complete");} catch (error) {console.error("Error during initialization:", error);}}// Ensure the document is fully loaded before initializingif (document.readyState === 'loading') {document.addEventListener('DOMContentLoaded', init);} else {// If already loaded, initialize immediatelyinit();}// Make navigation functions globally availablewindow.goToSection = goToSection;window.goToNextSection = goToNextSection;window.goToPreviousSection = goToPreviousSection;window.goToNextItem = goToNextItem;window.goToPreviousItem = goToPreviousItem;window.render = render;